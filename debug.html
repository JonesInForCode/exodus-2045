<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exodus 2045 - Debug Helper</title>
    <style>
      body {
        font-family: "Courier New", monospace;
        background: #0f172a;
        color: #10b981;
        margin: 20px;
        line-height: 1.6;
      }
      .container {
        max-width: 800px;
      }
      .status-check {
        background: #1e293b;
        padding: 15px;
        margin: 10px 0;
        border-left: 4px solid #10b981;
      }
      .error {
        border-left-color: #ef4444;
        color: #ef4444;
      }
      .warning {
        border-left-color: #f59e0b;
        color: #f59e0b;
      }
      button {
        background: #10b981;
        color: #0f172a;
        border: none;
        padding: 10px 20px;
        margin: 5px;
        font-family: "Courier New", monospace;
        cursor: pointer;
      }
      button:hover {
        background: #059669;
      }
      #log {
        background: #000;
        color: #00ff00;
        padding: 15px;
        height: 300px;
        overflow-y: auto;
        font-size: 12px;
        white-space: pre-wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üõ†Ô∏è Exodus 2045 - Debug Helper</h1>
      <p>Use this page to diagnose loading issues and verify file structure.</p>

      <div id="status-container">
        <div class="status-check">üìÅ Checking file structure...</div>
      </div>

      <div>
        <button onclick="checkFiles()">üîç Check Files</button>
        <button onclick="testPhaser()">üéÆ Test Phaser</button>
        <button onclick="testGame()">üöÄ Launch Game</button>
        <button onclick="clearLog()">üóëÔ∏è Clear Log</button>
      </div>

      <h3>üìã Console Log:</h3>
      <div id="log"></div>
    </div>

    <script>
      function log(message) {
        const logEl = document.getElementById("log");
        const timestamp = new Date().toLocaleTimeString();
        logEl.textContent += `[${timestamp}] ${message}\n`;
        logEl.scrollTop = logEl.scrollHeight;
      }

      function clearLog() {
        document.getElementById("log").textContent = "";
      }

      function updateStatus(message, type = "success") {
        const container = document.getElementById("status-container");
        const className =
          type === "error"
            ? "status-check error"
            : type === "warning"
            ? "status-check warning"
            : "status-check";
        container.innerHTML = `<div class="${className}">${message}</div>`;
      }

      async function checkFiles() {
        log("üîç Starting file structure check...");
        updateStatus("üìÅ Checking files...");

        const filesToCheck = [
          "/src/main.js",
          "/src/scenes/CoordinatorTerminal.js",
          "/src/scenes/MapView.js",
          "/src/scenes/GameUI.js",
          "/src/data/caravans.json",
        ];

        let allGood = true;

        for (const file of filesToCheck) {
          try {
            const response = await fetch(file);
            if (response.ok) {
              log(`‚úÖ Found: ${file}`);
            } else {
              log(`‚ùå Missing: ${file} (${response.status})`);
              allGood = false;
            }
          } catch (error) {
            log(`‚ùå Error loading ${file}: ${error.message}`);
            allGood = false;
          }
        }

        if (allGood) {
          updateStatus("‚úÖ All files found!");
          log("üéâ File structure check complete - all good!");
        } else {
          updateStatus("‚ùå Some files are missing", "error");
          log("‚ö†Ô∏è Some files are missing - check the log above");
        }
      }

      function testPhaser() {
        log("üéÆ Testing Phaser availability...");

        if (typeof Phaser !== "undefined") {
          log(`‚úÖ Phaser ${Phaser.VERSION} loaded successfully`);
          updateStatus("‚úÖ Phaser loaded");
        } else {
          log("‚ùå Phaser not loaded");
          updateStatus("‚ùå Phaser not available", "error");

          // Try to load Phaser
          log("üì• Attempting to load Phaser...");
          const script = document.createElement("script");
          script.src =
            "https://cdnjs.cloudflare.com/ajax/libs/phaser/3.70.0/phaser.min.js";
          script.onload = () => {
            log("‚úÖ Phaser loaded from CDN");
            updateStatus("‚úÖ Phaser loaded from CDN");
          };
          script.onerror = () => {
            log("‚ùå Failed to load Phaser from CDN");
            updateStatus("‚ùå Phaser loading failed", "error");
          };
          document.head.appendChild(script);
        }
      }

      function testGame() {
        log("üöÄ Attempting to launch game...");
        window.open("index.html", "_blank");
      }

      // Auto-check on load
      window.addEventListener("load", () => {
        log("üõ†Ô∏è Debug helper loaded");
        setTimeout(checkFiles, 1000);
        setTimeout(testPhaser, 2000);
      });

      // Capture console messages
      const originalLog = console.log;
      const originalError = console.error;
      const originalWarn = console.warn;

      console.log = function (...args) {
        log("üìù LOG: " + args.join(" "));
        originalLog.apply(console, args);
      };

      console.error = function (...args) {
        log("üí• ERROR: " + args.join(" "));
        originalError.apply(console, args);
      };

      console.warn = function (...args) {
        log("‚ö†Ô∏è WARN: " + args.join(" "));
        originalWarn.apply(console, args);
      };
    </script>
  </body>
</html>
