<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exodus 2045 - Coordination Terminal</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Courier New", monospace;
        background: #0a0a0a;
        color: #00ff41;
        overflow: hidden;
      }

      #game-container {
        width: 100vw;
        height: 100vh;
        position: relative;
      }

      #loading {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #0a0a0a;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        z-index: 1000;
      }

      #loading.hidden {
        display: none;
      }

      .loading-text {
        color: #00ff41;
        font-size: 1.2rem;
        margin-bottom: 1rem;
        text-shadow: 0 0 10px #00ff41;
      }

      .loading-bar {
        width: 300px;
        height: 20px;
        border: 2px solid #00ff41;
        background: transparent;
        position: relative;
        margin-bottom: 1rem;
      }

      .loading-fill {
        height: 100%;
        background: #00ff41;
        width: 0%;
        transition: width 0.3s ease;
        box-shadow: 0 0 15px #00ff41;
      }

      .system-info {
        color: #555;
        font-size: 0.8rem;
        text-align: center;
        line-height: 1.4;
      }

      @keyframes blink {
        0%,
        50% {
          opacity: 1;
        }
        51%,
        100% {
          opacity: 0;
        }
      }

      .blink {
        animation: blink 1s infinite;
      }
    </style>
  </head>
  <body>
    <div id="game-container">
      <!-- Loading Screen -->
      <div id="loading">
        <div class="loading-text">EXODUS COORDINATION SYSTEM</div>
        <div class="loading-text">
          Initializing Terminal<span class="blink">_</span>
        </div>
        <div class="loading-bar">
          <div class="loading-fill" id="loading-fill"></div>
        </div>
        <div class="system-info">
          üõ∞Ô∏è Establishing satellite uplink...<br />
          üì° Loading caravan tracking data...<br />
          üó∫Ô∏è Calibrating GPS coordinates...<br />
          ‚ö° Initializing crisis management protocols...
        </div>
      </div>

      <!-- Game will be injected here -->
      <div id="phaser-game"></div>
    </div>

    <!-- Load Phaser from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.70.0/phaser.min.js"></script>

    <script>
      // Coordinator Terminal Scene - All in one file for simplicity
      class CoordinatorTerminal extends Phaser.Scene {
        constructor() {
          super({ key: "CoordinatorTerminal" });
          this.terminalElements = {};
          this.currentTime = new Date();
          this.timeInterval = null;
        }

        preload() {
          // Create simple colored rectangles for UI elements
          this.load.image(
            "pixel",
            "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
          );
        }

        create() {
          this.createTerminalInterface();
          this.createTimeDisplay();
          this.createResourcePanel();
          this.createMessagePanel();
          this.createCaravanPanel();
          this.createControlPanel();
          this.startGameClock();
          this.initializeSampleData();

          console.log("üñ•Ô∏è Coordinator Terminal Online");
        }

        createTerminalInterface() {
          const { width, height } = this.scale;

          // Main terminal background
          this.add.rectangle(0, 0, width, height, 0x0f172a).setOrigin(0, 0);

          // Terminal header
          const headerHeight = 60;
          this.add
            .rectangle(0, 0, width, headerHeight, 0x1e293b)
            .setOrigin(0, 0);

          // Header text
          this.add.text(20, 15, "üõ∞Ô∏è EXODUS COORDINATION CENTER", {
            fontFamily: "Courier New",
            fontSize: "18px",
            color: "#10b981",
            fontWeight: "bold",
          });

          this.add.text(
            20,
            35,
            "Operator: Sarah Martinez | Shift: Day-7 | Clearance: Level-3",
            {
              fontFamily: "Courier New",
              fontSize: "12px",
              color: "#94a3b8",
            }
          );

          // System status indicator
          this.systemStatus = this.add
            .text(width - 20, 20, "üü¢ ALL SYSTEMS OPERATIONAL", {
              fontFamily: "Courier New",
              fontSize: "12px",
              color: "#10b981",
            })
            .setOrigin(1, 0);

          this.headerHeight = headerHeight;
        }

        createTimeDisplay() {
          const { width } = this.scale;
          this.timeDisplay = this.add
            .text(width - 20, 40, this.formatTime(this.currentTime), {
              fontFamily: "Courier New",
              fontSize: "24px",
              color: "#f59e0b",
              fontWeight: "bold",
            })
            .setOrigin(1, 0);
        }

        createResourcePanel() {
          const panelX = 20;
          const panelY = this.headerHeight + 20;
          const panelWidth = 250;
          const panelHeight = 200;

          // Panel background
          this.add
            .rectangle(panelX, panelY, panelWidth, panelHeight, 0x1e293b)
            .setOrigin(0, 0)
            .setStrokeStyle(1, 0x334155);

          // Panel header
          this.add.text(panelX + 10, panelY + 10, "GLOBAL RESOURCES", {
            fontFamily: "Courier New",
            fontSize: "12px",
            color: "#f59e0b",
            fontWeight: "bold",
          });

          // Resource indicators
          const resources = [
            { label: "Supply Drops Available", value: 5, color: "#10b981" },
            { label: "Active Drones", value: 3, color: "#06b6d4" },
            { label: "Fuel Depots Online", value: 8, color: "#f59e0b" },
            { label: "Medical Teams", value: 2, color: "#ef4444" },
          ];

          resources.forEach((resource, index) => {
            const y = panelY + 40 + index * 30;

            this.add.text(panelX + 15, y, resource.label, {
              fontFamily: "Courier New",
              fontSize: "10px",
              color: "#cbd5e1",
            });

            this.add
              .text(panelX + panelWidth - 30, y, resource.value.toString(), {
                fontFamily: "Courier New",
                fontSize: "14px",
                color: resource.color,
                fontWeight: "bold",
              })
              .setOrigin(1, 0);
          });
        }

        createMessagePanel() {
          const { width } = this.scale;
          const panelX = 290;
          const panelY = this.headerHeight + 20;
          const panelWidth = width - 560;
          const panelHeight = 300;

          // Panel background
          this.add
            .rectangle(panelX, panelY, panelWidth, panelHeight, 0x1e293b)
            .setOrigin(0, 0)
            .setStrokeStyle(1, 0x334155);

          // Panel header
          this.add.text(
            panelX + 10,
            panelY + 10,
            "üìß INCOMING COMMUNICATIONS",
            {
              fontFamily: "Courier New",
              fontSize: "12px",
              color: "#f59e0b",
              fontWeight: "bold",
            }
          );

          // Message list area
          this.messageContainer = this.add.container(panelX + 10, panelY + 35);
        }

        createCaravanPanel() {
          const { width } = this.scale;
          const panelX = width - 250;
          const panelY = this.headerHeight + 20;
          const panelWidth = 230;
          const panelHeight = 400;

          // Panel background
          this.add
            .rectangle(panelX, panelY, panelWidth, panelHeight, 0x1e293b)
            .setOrigin(0, 0)
            .setStrokeStyle(1, 0x334155);

          // Panel header
          this.add.text(panelX + 10, panelY + 10, "üìç CARAVAN TRACKING", {
            fontFamily: "Courier New",
            fontSize: "12px",
            color: "#f59e0b",
            fontWeight: "bold",
          });

          // Caravan list container
          this.caravanContainer = this.add.container(panelX + 10, panelY + 35);
        }

        createControlPanel() {
          const { width, height } = this.scale;
          const panelHeight = 80;
          const panelY = height - panelHeight;

          // Panel background
          this.add
            .rectangle(0, panelY, width, panelHeight, 0x334155)
            .setOrigin(0, 0);

          // Time control buttons
          const timeControls = [
            { text: "‚è∏Ô∏è PAUSE", speed: 0, x: 50 },
            { text: "‚ñ∂Ô∏è 1X", speed: 1, x: 150 },
            { text: "‚è© 2X", speed: 2, x: 230 },
            { text: "‚è©‚è© 4X", speed: 4, x: 310 },
          ];

          this.timeControlButtons = [];

          timeControls.forEach((control) => {
            const button = this.createButton(
              control.x,
              panelY + 20,
              control.text,
              () => {
                this.setTimeSpeed(control.speed);
              }
            );
            this.timeControlButtons.push({ button, speed: control.speed });
          });

          // Current speed indicator
          this.speedIndicator = this.add.text(400, panelY + 30, "Speed: 1X", {
            fontFamily: "Courier New",
            fontSize: "14px",
            color: "#10b981",
          });

          // System controls
          this.createButton(width - 200, panelY + 20, "üìª OPEN RADIO", () => {
            console.log("üìª Radio channel opened - Feature coming in Phase 2");
          });
        }

        createButton(x, y, text, callback) {
          const button = this.add
            .text(x, y, text, {
              fontFamily: "Courier New",
              fontSize: "12px",
              color: "#e2e8f0",
              backgroundColor: "#475569",
              padding: { x: 10, y: 5 },
            })
            .setInteractive();

          button.on("pointerover", () => {
            button.setStyle({ backgroundColor: "#10b981", color: "#0f172a" });
          });

          button.on("pointerout", () => {
            button.setStyle({ backgroundColor: "#475569", color: "#e2e8f0" });
          });

          button.on("pointerdown", callback);

          return button;
        }

        startGameClock() {
          this.timeInterval = setInterval(() => {
            this.currentTime.setMinutes(this.currentTime.getMinutes() + 1);
            this.timeDisplay.setText(this.formatTime(this.currentTime));
          }, 1000);
        }

        setTimeSpeed(speed) {
          const speedText = speed === 0 ? "PAUSED" : `${speed}X`;
          this.speedIndicator.setText(`Speed: ${speedText}`);

          this.timeControlButtons.forEach(({ button, speed: buttonSpeed }) => {
            if (buttonSpeed === speed) {
              button.setStyle({ backgroundColor: "#10b981", color: "#0f172a" });
            } else {
              button.setStyle({ backgroundColor: "#475569", color: "#e2e8f0" });
            }
          });

          console.log(`‚è±Ô∏è Time speed set to: ${speedText}`);
        }

        initializeSampleData() {
          // Add sample messages
          const sampleMessages = [
            {
              id: 1,
              from: "Caravan Alpha-7",
              subject: "URGENT: Dust storm approaching",
              time: "14:23",
              priority: "high",
              status: "unread",
            },
            {
              id: 2,
              from: "Weather Station Delta",
              subject: "Extreme heat warning - Zone 7",
              time: "13:45",
              priority: "medium",
              status: "unread",
            },
          ];

          this.displayMessages(sampleMessages);

          // Add sample caravan data
          const sampleCaravans = [
            {
              id: "Alpha-7",
              leader: "Maria Santos",
              members: 12,
              status: "moving",
              fuel: 60,
              water: 45,
              lastContact: "14:23",
            },
          ];

          this.displayCaravans(sampleCaravans);
        }

        displayMessages(messages) {
          this.messageContainer.removeAll(true);

          messages.forEach((message, index) => {
            const y = index * 40;
            const priorityColor =
              message.priority === "high"
                ? "#ef4444"
                : message.priority === "medium"
                ? "#f59e0b"
                : "#10b981";

            // Priority indicator
            this.messageContainer.add(
              this.add.circle(5, y + 10, 4, priorityColor)
            );

            // Message text
            this.messageContainer.add(
              this.add.text(20, y, `${message.from}`, {
                fontFamily: "Courier New",
                fontSize: "10px",
                color: "#10b981",
                fontWeight: "bold",
              })
            );

            this.messageContainer.add(
              this.add.text(20, y + 12, message.subject, {
                fontFamily: "Courier New",
                fontSize: "9px",
                color: "#e2e8f0",
              })
            );

            this.messageContainer.add(
              this.add.text(20, y + 24, message.time, {
                fontFamily: "Courier New",
                fontSize: "8px",
                color: "#94a3b8",
              })
            );
          });
        }

        displayCaravans(caravans) {
          this.caravanContainer.removeAll(true);

          caravans.forEach((caravan, index) => {
            const y = index * 80;

            // Caravan ID
            this.caravanContainer.add(
              this.add.text(0, y, caravan.id, {
                fontFamily: "Courier New",
                fontSize: "12px",
                color: "#10b981",
                fontWeight: "bold",
              })
            );

            // Leader
            this.caravanContainer.add(
              this.add.text(0, y + 15, `Leader: ${caravan.leader}`, {
                fontFamily: "Courier New",
                fontSize: "9px",
                color: "#cbd5e1",
              })
            );

            // Members
            this.caravanContainer.add(
              this.add.text(0, y + 27, `Members: ${caravan.members}`, {
                fontFamily: "Courier New",
                fontSize: "9px",
                color: "#cbd5e1",
              })
            );

            // Status
            const statusColor =
              caravan.status === "moving" ? "#10b981" : "#f59e0b";
            this.caravanContainer.add(
              this.add.text(0, y + 39, `Status: ${caravan.status}`, {
                fontFamily: "Courier New",
                fontSize: "9px",
                color: statusColor,
              })
            );

            // Resources
            this.caravanContainer.add(
              this.add.text(
                0,
                y + 51,
                `Fuel: ${caravan.fuel}% | Water: ${caravan.water}%`,
                {
                  fontFamily: "Courier New",
                  fontSize: "8px",
                  color: "#94a3b8",
                }
              )
            );
          });
        }

        formatTime(date) {
          return date.toLocaleTimeString("en-US", {
            hour12: false,
            hour: "2-digit",
            minute: "2-digit",
            second: "2-digit",
          });
        }

        destroy() {
          if (this.timeInterval) {
            clearInterval(this.timeInterval);
          }
          super.destroy();
        }
      }

      // Game configuration
      const config = {
        type: Phaser.AUTO,
        width: window.innerWidth,
        height: window.innerHeight,
        parent: "phaser-game",
        backgroundColor: "#0f172a",
        scene: [CoordinatorTerminal],
        physics: {
          default: "arcade",
          arcade: {
            gravity: { y: 0 },
            debug: false,
          },
        },
        scale: {
          mode: Phaser.Scale.RESIZE,
          autoCenter: Phaser.Scale.CENTER_BOTH,
        },
        render: {
          antialias: false,
          pixelArt: true,
        },
      };

      // Loading simulation
      function simulateLoading() {
        const loadingElement = document.getElementById("loading");
        const loadingFill = document.getElementById("loading-fill");

        let progress = 0;
        const interval = setInterval(() => {
          progress += Math.random() * 15;
          if (progress >= 100) {
            progress = 100;
            clearInterval(interval);

            // Hide loading screen and start game
            setTimeout(() => {
              loadingElement.classList.add("hidden");
              initializeGame();
            }, 500);
          }

          loadingFill.style.width = `${progress}%`;
        }, 200);
      }

      // Initialize Phaser game
      function initializeGame() {
        const game = new Phaser.Game(config);

        // Handle window resize
        window.addEventListener("resize", () => {
          game.scale.resize(window.innerWidth, window.innerHeight);
        });

        // Global key bindings
        document.addEventListener("keydown", (event) => {
          switch (event.code) {
            case "Space":
              event.preventDefault();
              console.log("Space pressed - pause functionality");
              break;
            case "Digit1":
              console.log("1x speed");
              break;
            case "Digit2":
              console.log("2x speed");
              break;
            case "Digit4":
              console.log("4x speed");
              break;
          }
        });

        console.log("üõ∞Ô∏è Exodus 2045 Coordination System Online");
        console.log("üìã Phase 1: Foundation - Terminal Interface Active");
      }

      // Start loading process when DOM is ready
      document.addEventListener("DOMContentLoaded", () => {
        console.log("DOM loaded, starting game...");
        simulateLoading();
      });
    </script>
  </body>
</html>
